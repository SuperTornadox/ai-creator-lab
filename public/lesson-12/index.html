<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lesson 12: Final Project — Polish &amp; Present - AI Creator Lab</title>
  <link rel="stylesheet" href="/shared/styles.css">
  <style>
    /* Tab navigation (same as Lesson 11) */
    .tool-tabs {
      display: flex;
      gap: var(--space-xs);
      margin-bottom: var(--space-lg);
      padding-bottom: var(--space-md);
      border-bottom: 2px solid var(--color-border);
      flex-wrap: wrap;
    }

    .tool-tab {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: 0.55em 1.1em;
      font-size: var(--text-md);
      font-weight: 600;
      font-family: inherit;
      border: 2px solid var(--color-border);
      background: var(--color-surface);
      color: var(--color-text-muted);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--transition-fast);
      white-space: nowrap;
    }

    .tool-tab:hover {
      border-color: var(--color-primary);
      color: var(--color-text);
    }

    .tool-tab.active {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: #ffffff;
    }

    .tool-panel {
      display: none;
    }

    .tool-panel.active {
      display: block;
    }

    /* Section spacing */
    .lesson-section {
      margin-bottom: var(--space-xl);
      padding-bottom: var(--space-xl);
      border-bottom: 1px solid var(--color-border);
    }

    .lesson-section:last-child {
      border-bottom: none;
    }

    .section-heading {
      font-size: var(--text-xl);
      font-weight: 650;
      margin-bottom: var(--space-lg);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    /* Presentation prep */
    .presentation-form {
      display: flex;
      flex-direction: column;
      gap: var(--space-lg);
    }

    .project-title-display {
      font-size: var(--text-2xl);
      font-weight: 800;
      text-align: center;
      padding: var(--space-lg);
      background: linear-gradient(135deg, var(--color-primary-light) 0%, var(--color-secondary-light) 100%);
      border-radius: var(--radius-lg);
      color: var(--color-text);
      letter-spacing: -0.02em;
    }

    .project-title-display .title-label {
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--color-text-muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
      margin-bottom: var(--space-xs);
    }

    /* Presentation mode overlay */
    .presentation-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: linear-gradient(160deg, #f8f9fc 0%, #eef1fb 50%, #f0edfb 100%);
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-xl);
      text-align: center;
      overflow-y: auto;
    }

    .presentation-overlay.active {
      display: flex;
    }

    .presentation-overlay .pres-title {
      font-size: 3rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: var(--space-lg);
    }

    .presentation-overlay .pres-section {
      max-width: 700px;
      margin-bottom: var(--space-lg);
      text-align: left;
    }

    .presentation-overlay .pres-section h3 {
      color: var(--color-primary);
      margin-bottom: var(--space-sm);
    }

    .presentation-overlay .pres-section p {
      font-size: var(--text-lg);
      line-height: 1.7;
      color: var(--color-text);
      white-space: pre-wrap;
    }

    .presentation-overlay .pres-close {
      position: fixed;
      top: 20px;
      right: 24px;
      background: var(--color-text);
      color: #fff;
      border: none;
      border-radius: var(--radius-full);
      width: 40px;
      height: 40px;
      font-size: var(--text-lg);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity var(--transition-fast);
    }

    .presentation-overlay .pres-close:hover {
      opacity: 0.7;
    }

    .presentation-overlay .pres-by {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-top: var(--space-sm);
    }

    /* Presentation mode button */
    .presentation-btn {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
      padding: 0.8em 2em;
      font-size: var(--text-lg);
      font-weight: 700;
      font-family: inherit;
      background: linear-gradient(135deg, var(--color-secondary), var(--color-primary));
      color: #ffffff;
      border: none;
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .presentation-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .presentation-btn:active {
      transform: scale(0.97);
    }

    /* Graduation section */
    .graduation-section {
      text-align: center;
      padding: var(--space-xl);
      background: linear-gradient(135deg, #fef3c7 0%, #fce7f3 50%, #ede9fe 100%);
      border-radius: var(--radius-lg);
      border: 2px solid #fbbf24;
    }

    .graduation-section .grad-emoji {
      font-size: 4rem;
      margin-bottom: var(--space-md);
    }

    .graduation-section h2 {
      font-size: var(--text-2xl);
      font-weight: 800;
      background: linear-gradient(135deg, #f59e0b, #ec4899, #7c3aed);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: var(--space-sm);
    }

    .graduation-section .grad-subtitle {
      font-size: var(--text-lg);
      color: var(--color-text-muted);
      margin-bottom: var(--space-lg);
    }

    .graduation-section .grad-skills {
      display: flex;
      justify-content: center;
      gap: var(--space-lg);
      flex-wrap: wrap;
      margin-bottom: var(--space-lg);
    }

    .graduation-section .grad-skill {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-xs);
    }

    .graduation-section .grad-skill .skill-emoji {
      font-size: 2rem;
    }

    .graduation-section .grad-skill .skill-label {
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--color-text);
    }

    .graduation-section .grad-message {
      font-size: var(--text-md);
      color: var(--color-text);
      max-width: 500px;
      margin: 0 auto;
      line-height: 1.7;
    }

    /* Export row */
    .export-row {
      display: flex;
      gap: var(--space-md);
      align-items: center;
      margin-top: var(--space-md);
    }
  </style>
</head>
<body>

  <!-- Lesson Header -->
  <header class="lesson-header">
    <div class="lesson-badge">
      <span class="lesson-number">12</span>
      <span class="lesson-title">Final Project: Polish &amp; Present</span>
    </div>
    <a href="/" class="back-link">&larr; Back to all lessons</a>
  </header>

  <!-- Presentation Mode Overlay -->
  <div class="presentation-overlay" id="presentation-overlay">
    <button class="pres-close" id="pres-close-btn" title="Exit Presentation Mode">&times;</button>
    <div class="pres-title" id="pres-display-title">My Project</div>
    <div class="pres-by" id="pres-display-by"></div>
    <div class="pres-section">
      <h3>About My Project</h3>
      <p id="pres-display-about">...</p>
    </div>
    <div class="pres-section">
      <h3>My Creative Process</h3>
      <p id="pres-display-process">...</p>
    </div>
  </div>

  <!-- Page Layout -->
  <div class="lesson-page">

    <!-- Main Content Area -->
    <main class="lesson-main" id="main-content">

      <!-- Section 1: Final Polish Tools -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x2728; Final Polish</h2>

        <!-- Tab Navigation -->
        <div class="tool-tabs" id="tool-tabs">
          <button class="tool-tab active" data-tab="text">&#x1F4AC; Text AI</button>
          <button class="tool-tab" data-tab="image">&#x1F3A8; Image AI</button>
          <button class="tool-tab" data-tab="code">&#x1F4BB; Code AI</button>
          <button class="tool-tab" data-tab="gallery">&#x1F5BC;&#xFE0F; My Gallery</button>
        </div>

        <!-- Tab Panels -->
        <div class="tool-panel active" id="panel-text">
          <div id="text-chat"></div>
        </div>

        <div class="tool-panel" id="panel-image">
          <div id="image-gen"></div>
        </div>

        <div class="tool-panel" id="panel-code">
          <div id="code-playground"></div>
        </div>

        <div class="tool-panel" id="panel-gallery">
          <p style="color: var(--color-text-muted); margin-bottom: var(--space-md); font-size: var(--text-sm);">Your collected images appear here.</p>
          <div id="gallery-container"></div>
        </div>
      </div>

      <!-- Section 2: Presentation Prep -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F3A4; Presentation Prep</h2>

        <div class="presentation-form">
          <!-- Project Title Display -->
          <div class="project-title-display">
            <div class="title-label">My Final Project</div>
            <div id="project-title-text">Untitled Project</div>
          </div>

          <div class="form-group">
            <label for="pres-about">About My Project</label>
            <textarea id="pres-about" class="textarea" placeholder="Describe your project: What is it? What tools did you use? What is it about?&#10;&#10;For example: My project is an AI Magazine about space exploration. I used Text AI to write articles and Image AI to create illustrations for each page."></textarea>
          </div>

          <div class="form-group">
            <label for="pres-process">My Creative Process</label>
            <textarea id="pres-process" class="textarea" placeholder="How did you make it? What challenges did you face? What did you learn?&#10;&#10;For example: I started by brainstorming article topics with AI. The hardest part was getting the images to match exactly what I imagined. I learned that writing good prompts is really important!"></textarea>
          </div>

          <div class="text-center" style="margin-top: var(--space-md);">
            <button class="presentation-btn" id="presentation-mode-btn">
              &#x1F4FA; Launch Presentation Mode
            </button>
          </div>

          <div class="export-row">
            <div id="export-btn-container"></div>
          </div>
        </div>
      </div>

      <!-- Section 3: Graduation -->
      <div class="lesson-section">
        <div class="graduation-section">
          <div class="grad-emoji">&#x1F393;&#x1F389;</div>
          <h2>Congratulations, AI Creator!</h2>
          <p class="grad-subtitle">You completed the entire AI Creator Lab course!</p>
          <div class="grad-skills">
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F4AC;</span>
              <span class="skill-label">Text AI</span>
            </div>
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F3A8;</span>
              <span class="skill-label">Image AI</span>
            </div>
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F3B5;</span>
              <span class="skill-label">Music AI</span>
            </div>
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F3AC;</span>
              <span class="skill-label">Film AI</span>
            </div>
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F4BB;</span>
              <span class="skill-label">Code AI</span>
            </div>
            <div class="grad-skill">
              <span class="skill-emoji">&#x1F3AE;</span>
              <span class="skill-label">Game AI</span>
            </div>
          </div>
          <p class="grad-message">
            You started as a beginner and became an AI Creator. You learned to chat, write, draw, compose, code, and build with AI. Remember: AI is a powerful tool, and YOU are the creative force behind it. Keep creating, keep learning, and keep being awesome!
          </p>
        </div>
      </div>

    </main>

    <!-- Task Sidebar -->
    <aside class="lesson-sidebar">
      <div class="task-sidebar" id="task-sidebar"></div>
    </aside>

  </div>

  <script src="/shared/components.js"></script>
  <script>
    // =============================================
    // Load Project Plan for Title Display
    // =============================================
    var PLAN_KEY = 'finalProjectPlan';
    var titleDisplay = document.getElementById('project-title-text');
    var savedPlan = null;

    try {
      var raw = localStorage.getItem(PLAN_KEY);
      if (raw) {
        savedPlan = JSON.parse(raw);
        if (savedPlan && savedPlan.title) {
          titleDisplay.textContent = savedPlan.title;
        }
      }
    } catch (e) { /* ignore */ }

    // =============================================
    // Tab Navigation
    // =============================================
    var tabs = document.querySelectorAll('.tool-tab');
    var panels = document.querySelectorAll('.tool-panel');

    tabs.forEach(function (tab) {
      tab.addEventListener('click', function () {
        var target = tab.getAttribute('data-tab');

        tabs.forEach(function (t) { t.classList.remove('active'); });
        panels.forEach(function (p) { p.classList.remove('active'); });

        tab.classList.add('active');
        var panel = document.getElementById('panel-' + target);
        if (panel) panel.classList.add('active');
      });
    });

    // =============================================
    // Tool Initialization
    // =============================================

    // Text AI
    var textChat = document.getElementById('text-chat');
    window.ChatWidget(textChat, {
      systemPrompt: "You are a helpful assistant for a student doing final polish on their AI project. Help them refine text, improve descriptions, fix wording, write presentation notes, or brainstorm final touches. Be encouraging — they are about to present! Keep responses concise and age-appropriate for a 12-13 year old.",
      placeholder: "Need help polishing your project or writing your presentation?"
    });

    // Image AI
    var imageGenContainer = document.getElementById('image-gen');
    var gallery = null;

    var imageGen = window.ImageGenerator(imageGenContainer, {
      showGallery: true,
      onGenerate: function (data) {
        if (gallery && data && data.url) {
          gallery.addImage(data.url, data.prompt || '');
        }
      }
    });

    // Code AI
    var codePG = document.getElementById('code-playground');
    window.CodePlayground(codePG, {});

    // Gallery
    var galleryContainer = document.getElementById('gallery-container');
    gallery = window.Gallery(galleryContainer, { columns: 3 });

    // =============================================
    // Presentation Prep (auto-save)
    // =============================================
    var PRES_KEY = 'presentationPrep_lesson12';
    var presAbout = document.getElementById('pres-about');
    var presProcess = document.getElementById('pres-process');

    // Load saved
    try {
      var savedPres = localStorage.getItem(PRES_KEY);
      if (savedPres) {
        var presData = JSON.parse(savedPres);
        if (presData.about) presAbout.value = presData.about;
        if (presData.process) presProcess.value = presData.process;
      }
    } catch (e) { /* ignore */ }

    function savePresentation() {
      try {
        localStorage.setItem(PRES_KEY, JSON.stringify({
          about: presAbout.value,
          process: presProcess.value
        }));
      } catch (e) { /* ignore */ }
    }

    presAbout.addEventListener('input', savePresentation);
    presProcess.addEventListener('input', savePresentation);

    // =============================================
    // Presentation Mode
    // =============================================
    var overlay = document.getElementById('presentation-overlay');
    var presBtn = document.getElementById('presentation-mode-btn');
    var closeBtn = document.getElementById('pres-close-btn');
    var presDisplayTitle = document.getElementById('pres-display-title');
    var presDisplayBy = document.getElementById('pres-display-by');
    var presDisplayAbout = document.getElementById('pres-display-about');
    var presDisplayProcess = document.getElementById('pres-display-process');

    presBtn.addEventListener('click', function () {
      // Populate the overlay
      presDisplayTitle.textContent = titleDisplay.textContent || 'My Project';

      var studentName = '';
      try {
        studentName = sessionStorage.getItem('studentName') || '';
      } catch (e) { /* ignore */ }
      presDisplayBy.textContent = studentName ? 'by ' + studentName : '';

      presDisplayAbout.textContent = presAbout.value.trim() || '(No description written yet)';
      presDisplayProcess.textContent = presProcess.value.trim() || '(No process notes written yet)';

      overlay.classList.add('active');
      taskCards.setComplete('present', true);
    });

    closeBtn.addEventListener('click', function () {
      overlay.classList.remove('active');
    });

    // Escape to close
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && overlay.classList.contains('active')) {
        overlay.classList.remove('active');
      }
    });

    // =============================================
    // Export Button
    // =============================================
    var exportContainer = document.getElementById('export-btn-container');
    window.ExportButton(exportContainer, {
      label: 'Export Presentation',
      getData: function () {
        var title = titleDisplay.textContent || 'My Project';
        var about = presAbout.value || '';
        var process = presProcess.value || '';
        return '=== ' + title.toUpperCase() + ' ===\n\n' +
               '--- About My Project ---\n' + about + '\n\n' +
               '--- My Creative Process ---\n' + process + '\n';
      },
      filename: 'my-presentation.txt',
      format: 'text'
    });

    // =============================================
    // Task Sidebar
    // =============================================
    var taskSidebar = document.getElementById('task-sidebar');
    var taskCards = window.TaskCards(taskSidebar, [
      { id: 'polish', title: 'Final polish', description: 'Add finishing touches to your project' },
      { id: 'write-pres', title: 'Write your presentation', description: 'Fill in "About" and "Creative Process"' },
      { id: 'practice', title: 'Practice presenting', description: 'Try Presentation Mode and rehearse' },
      { id: 'present', title: 'Present to the class!', description: 'Share your amazing project' },
      { id: 'celebrate', title: 'Celebrate!', description: 'You completed AI Creator Lab!' }
    ]);

    // Auto-check "write presentation" when both fields have content
    presAbout.addEventListener('input', function () {
      if (presAbout.value.trim() && presProcess.value.trim()) {
        taskCards.setComplete('write-pres', true);
      }
    });
    presProcess.addEventListener('input', function () {
      if (presAbout.value.trim() && presProcess.value.trim()) {
        taskCards.setComplete('write-pres', true);
      }
    });
  </script>

</body>
</html>
