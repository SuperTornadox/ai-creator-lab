<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lesson 4: AI Code — Build and Play - AI Creator Lab</title>
  <link rel="stylesheet" href="/shared/styles.css">
  <style>
    /* Section dividers */
    .lesson-section {
      margin-bottom: var(--space-xl);
      padding-bottom: var(--space-xl);
      border-bottom: 1px solid var(--color-border);
    }

    .lesson-section:last-child {
      border-bottom: none;
    }

    .section-heading {
      font-size: var(--text-xl);
      font-weight: 650;
      margin-bottom: var(--space-lg);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    /* Part divider */
    .part-divider {
      text-align: center;
      padding: var(--space-xl) 0;
      border-top: 3px solid var(--color-primary);
      border-bottom: 3px solid var(--color-primary);
      margin: var(--space-xl) 0;
      background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
      border-radius: var(--radius-lg);
    }

    .part-divider h2 {
      font-size: var(--text-2xl);
      margin-bottom: var(--space-xs);
    }

    .part-divider p {
      color: var(--color-text-muted);
      font-size: var(--text-md);
    }

    /* Welcome banner */
    .welcome-banner {
      background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
      border-radius: var(--radius-lg);
      padding: var(--space-xl);
      text-align: center;
      margin-bottom: var(--space-xl);
    }

    .welcome-banner h2 {
      margin-bottom: var(--space-sm);
    }

    .welcome-banner p {
      color: var(--color-text-muted);
      font-size: var(--text-md);
      max-width: 600px;
      margin-inline: auto;
      line-height: 1.6;
    }

    /* Challenge cards grid */
    .challenge-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
    }

    .challenge-card {
      background: var(--color-surface);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
      padding: var(--space-lg);
      border: 2px solid var(--color-border);
      text-align: center;
      cursor: pointer;
      transition: box-shadow var(--transition-normal),
                  transform var(--transition-normal),
                  border-color var(--transition-normal);
    }

    .challenge-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .challenge-card.card-selected {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px var(--color-primary-light);
    }

    .challenge-card .challenge-emoji {
      font-size: 2.5rem;
      margin-bottom: var(--space-sm);
    }

    .challenge-card .challenge-name {
      font-size: var(--text-md);
      font-weight: 650;
      margin-bottom: var(--space-xs);
    }

    .challenge-card .challenge-desc {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      line-height: 1.4;
    }

    .challenge-card .difficulty {
      display: inline-block;
      margin-top: var(--space-sm);
      font-size: var(--text-xs);
      font-weight: 700;
      padding: 0.2em 0.6em;
      border-radius: var(--radius-full);
    }

    .difficulty-easy {
      background: var(--color-success-light);
      color: #16a34a;
    }

    .difficulty-medium {
      background: var(--color-warning-light);
      color: #b45309;
    }

    .difficulty-hard {
      background: var(--color-secondary-light);
      color: var(--color-secondary);
    }

    /* Game type selector grid */
    .game-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: var(--space-lg);
    }

    .game-card {
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      padding: var(--space-xl) var(--space-lg);
      border: 2px solid var(--color-border);
      text-align: center;
      cursor: pointer;
      transition: box-shadow var(--transition-normal),
                  transform var(--transition-normal),
                  border-color var(--transition-normal);
      position: relative;
      overflow: hidden;
    }

    .game-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent 50%, rgba(79, 110, 247, 0.04) 100%);
      pointer-events: none;
    }

    .game-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-4px);
    }

    .game-card.card-selected {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px var(--color-primary-light);
    }

    .game-card .game-emoji {
      font-size: 3rem;
      margin-bottom: var(--space-sm);
      display: block;
    }

    .game-card .game-name {
      font-size: var(--text-lg);
      font-weight: 700;
      margin-bottom: var(--space-xs);
      color: var(--color-text);
    }

    .game-card .game-desc {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      line-height: 1.5;
    }

    .game-card .game-tag {
      display: inline-block;
      margin-top: var(--space-sm);
      padding: 0.15em 0.6em;
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      font-weight: 600;
      background: var(--color-primary-light);
      color: var(--color-primary);
    }

    .quick-start {
      position: absolute;
      top: var(--space-sm);
      right: var(--space-sm);
      background: var(--color-warning);
      color: #ffffff;
      font-size: var(--text-xs);
      font-weight: 700;
      padding: 0.15em 0.55em;
      border-radius: var(--radius-full);
    }

    /* Iteration tips */
    .tips-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: var(--space-md);
    }

    .tip-card {
      background: var(--color-surface);
      border-radius: var(--radius-md);
      border: 1px solid var(--color-border);
      padding: var(--space-md) var(--space-lg);
      transition: box-shadow var(--transition-normal),
                  transform var(--transition-normal);
      cursor: pointer;
    }

    .tip-card:hover {
      box-shadow: var(--shadow-sm);
      transform: translateY(-2px);
    }

    .tip-card .tip-emoji {
      font-size: 1.8rem;
      margin-bottom: var(--space-xs);
    }

    .tip-card .tip-title {
      font-size: var(--text-md);
      font-weight: 650;
      margin-bottom: var(--space-xs);
    }

    .tip-card .tip-desc {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      line-height: 1.5;
    }

    /* Playground containers */
    #playground-part1 {
      min-height: 500px;
    }

    .playground-wrapper {
      min-height: 500px;
    }

    .playground-wrapper .flex {
      flex-wrap: wrap;
    }

    /* Tips box */
    .tips-box {
      background: var(--color-accent-light);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      margin-top: var(--space-md);
    }

    .tips-box h4 {
      margin-bottom: var(--space-sm);
      color: var(--color-accent-hover);
    }

    .tips-box ul {
      list-style: none;
      padding: 0;
    }

    .tips-box li {
      padding: var(--space-xs) 0;
      font-size: var(--text-sm);
      line-height: 1.6;
    }

    .tips-box li::before {
      content: "\2728 ";
    }

    /* Export section */
    .export-section {
      background: var(--color-success-light);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-md);
      flex-wrap: wrap;
    }

    .export-section .export-info {
      flex: 1;
      min-width: 200px;
    }

    .export-section .export-info h3 {
      margin-bottom: var(--space-xs);
    }

    .export-section .export-info p {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
    }

    /* Vibe Coding section */
    .vibe-steps {
      display: flex;
      flex-direction: column;
      gap: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .vibe-step {
      display: flex;
      gap: var(--space-md);
      align-items: flex-start;
    }

    .vibe-step-num {
      flex-shrink: 0;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: var(--radius-full);
      background: var(--color-primary);
      color: #fff;
      font-weight: 800;
      font-size: var(--text-lg);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .vibe-step-content {
      flex: 1;
    }

    .vibe-step-content h3 {
      font-size: var(--text-md);
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .vibe-step-content > p {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      line-height: 1.5;
      margin-bottom: var(--space-sm);
    }

    .vibe-example {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .vibe-example-bad,
    .vibe-example-good {
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-sm);
      font-size: var(--text-sm);
      line-height: 1.5;
    }

    .vibe-example-bad {
      background: var(--color-error-light);
      border-left: 3px solid var(--color-error);
    }

    .vibe-example-good {
      background: var(--color-success-light);
      border-left: 3px solid var(--color-success);
    }

    .vibe-example-bad strong,
    .vibe-example-good strong {
      display: block;
      font-size: var(--text-xs);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.15em;
    }

    .vibe-example-good em {
      display: block;
      margin-top: var(--space-xs);
      font-size: var(--text-xs);
      color: var(--color-text-muted);
    }

    .vibe-example-good code {
      background: rgba(0,0,0,0.06);
      padding: 0.1em 0.3em;
      border-radius: 3px;
      font-size: 0.9em;
    }

    .vibe-challenge {
      background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
      border-radius: var(--radius-lg);
      padding: var(--space-xl);
    }

    .vibe-challenge h3 {
      font-size: var(--text-lg);
      margin-bottom: var(--space-xs);
    }

    .vibe-challenge > p {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-bottom: var(--space-md);
      line-height: 1.5;
    }

    .vibe-challenge-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .vibe-challenge-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      background: var(--color-surface);
      border-radius: var(--radius-md);
      padding: var(--space-md) var(--space-lg);
      border: 1px solid var(--color-border);
      cursor: pointer;
      transition: box-shadow var(--transition-normal), transform var(--transition-normal);
    }

    .vibe-challenge-item:hover {
      box-shadow: var(--shadow-sm);
      transform: translateY(-1px);
    }

    .vibe-challenge-icon {
      font-size: 1.8rem;
      flex-shrink: 0;
    }

    .vibe-challenge-item div {
      display: flex;
      flex-direction: column;
      gap: 0.15em;
    }

    .vibe-challenge-item strong {
      font-size: var(--text-md);
    }

    .vibe-challenge-item span {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      line-height: 1.4;
    }

    /* Responsive */
    @media (max-width: 767px) {
      #playground-part1 .flex,
      .playground-wrapper .flex {
        flex-direction: column;
      }

      .challenge-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>
<body>

  <!-- Lesson Header -->
  <header class="lesson-header">
    <div class="lesson-badge">
      <span class="lesson-number">04</span>
      <span class="lesson-title">AI Code &mdash; Build and Play</span>
    </div>
    <a href="/" class="back-link">&larr; Back to all lessons</a>
  </header>

  <!-- Page Layout -->
  <div class="lesson-page">

    <!-- Main Content Area -->
    <main class="lesson-main" id="main-content">

      <!-- ===== PART 1: AI Coder ===== -->

      <!-- Welcome Banner -->
      <div class="welcome-banner">
        <h2>&#x1F4BB; Welcome to AI Coder!</h2>
        <p>
          No experience needed &mdash; just describe what you want to build, and AI will write the code for you. You are in charge of the ideas!
        </p>
      </div>

      <!-- Challenge Cards -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F3AF; Pick a Challenge</h2>
        <p class="mb-md" style="color: var(--color-text-muted); font-size: var(--text-sm);">
          Click any challenge below to load its description into the playground. Start easy and work your way up!
        </p>
        <div class="challenge-grid" id="challenge-grid">
          <!-- Rendered by JS -->
        </div>
      </div>

      <!-- Code Playground Part 1 -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F6E0;&#xFE0F; Code Playground</h2>
        <div id="playground-part1"></div>

        <div class="tips-box">
          <h4>&#x1F4A1; Tips for Great Descriptions</h4>
          <ul>
            <li>Be specific! "A big red button" is better than "a button"</li>
            <li>Describe the behavior: "When I click it, the number goes up by 1"</li>
            <li>Start simple, then use "What to change?" to add features</li>
            <li>If something doesn't work, try describing it differently</li>
            <li>You can always click "Generate" again to start over</li>
          </ul>
        </div>
      </div>

      <!-- ===== VIBE CODING TECHNIQUES ===== -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F3B8; Vibe Coding — Pro Techniques</h2>
        <p style="margin-bottom: var(--space-md); color: var(--color-text-muted); max-width: 700px; line-height: 1.6;">
          <strong>Vibe coding</strong> means building software by describing what you want in plain language, then guiding AI step-by-step. Here are the techniques real developers use every day:
        </p>

        <div class="vibe-steps" id="vibe-steps">
          <div class="vibe-step">
            <div class="vibe-step-num">1</div>
            <div class="vibe-step-content">
              <h3>Start Simple, Then Iterate</h3>
              <p>Don't describe everything at once. Start with the basics, then add features one at a time.</p>
              <div class="vibe-example">
                <div class="vibe-example-bad">
                  <strong>Too much at once:</strong>
                  <span>"Make a quiz game with 10 questions, a timer, score tracking, animations, sound effects, difficulty levels, and a leaderboard"</span>
                </div>
                <div class="vibe-example-good">
                  <strong>Start simple:</strong>
                  <span>"Make a quiz with 3 questions and show the score at the end"</span>
                  <em>Then iterate: "Now add a timer" &rarr; "Now add sound effects" &rarr; ...</em>
                </div>
              </div>
            </div>
          </div>

          <div class="vibe-step">
            <div class="vibe-step-num">2</div>
            <div class="vibe-step-content">
              <h3>Debug by Describing the Problem</h3>
              <p>When something doesn't work, tell AI exactly what's wrong. Be a detective!</p>
              <div class="vibe-example">
                <div class="vibe-example-bad">
                  <strong>Vague:</strong>
                  <span>"It's broken, fix it"</span>
                </div>
                <div class="vibe-example-good">
                  <strong>Specific:</strong>
                  <span>"The score goes up by 2 instead of 1 when I click the button. Also the color doesn't change back after 1 second like I asked."</span>
                </div>
              </div>
            </div>
          </div>

          <div class="vibe-step">
            <div class="vibe-step-num">3</div>
            <div class="vibe-step-content">
              <h3>Read the Code (Even a Little)</h3>
              <p>You don't need to understand everything, but try to find the parts that match your description. Look for words you recognize!</p>
              <div class="vibe-example">
                <div class="vibe-example-good">
                  <strong>Try this:</strong>
                  <span>Look at the generated code and find where it says <code>score</code>, <code>color</code>, or <code>click</code>. If you asked for "the background turns blue when clicked", can you spot the line that does it?</span>
                </div>
              </div>
            </div>
          </div>

          <div class="vibe-step">
            <div class="vibe-step-num">4</div>
            <div class="vibe-step-content">
              <h3>Chain Your Prompts</h3>
              <p>Each "What to change?" builds on the last version. Think of it like giving directions one turn at a time, not all at once.</p>
              <div class="vibe-example">
                <div class="vibe-example-good">
                  <strong>Good chain:</strong>
                  <span>Generate: "A bouncing ball" &rarr; Change: "Make 3 balls" &rarr; Change: "Each ball is a different color" &rarr; Change: "When balls collide they swap colors"</span>
                </div>
              </div>
            </div>
          </div>

          <div class="vibe-step">
            <div class="vibe-step-num">5</div>
            <div class="vibe-step-content">
              <h3>Combine Ideas from Different Generations</h3>
              <p>If you generated something cool before, you can describe it to add it into your current project!</p>
              <div class="vibe-example">
                <div class="vibe-example-good">
                  <strong>Mix and match:</strong>
                  <span>"Take my current game and add a drawing canvas (like my earlier program) where the player can draw their own character before playing"</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Vibe Coding Challenge -->
        <div class="vibe-challenge" id="vibe-challenge">
          <h3>&#x1F3AF; Vibe Coding Challenge</h3>
          <p>Put your new skills to the test! Pick one challenge below and complete it using <strong>only</strong> the Part 1 playground above:</p>
          <div class="vibe-challenge-list">
            <div class="vibe-challenge-item" data-steps="3">
              <span class="vibe-challenge-icon">&#x1F680;</span>
              <div>
                <strong>3-Step Rocket</strong>
                <span>Start with "a red circle" &rarr; in 3 iterations, turn it into a mini-game with scoring</span>
              </div>
            </div>
            <div class="vibe-challenge-item" data-steps="4">
              <span class="vibe-challenge-icon">&#x1F41B;</span>
              <div>
                <strong>Bug Hunter</strong>
                <span>Generate any program, then ask for a feature that breaks it. Debug it using "describe the problem" technique</span>
              </div>
            </div>
            <div class="vibe-challenge-item" data-steps="5">
              <span class="vibe-challenge-icon">&#x1F9E9;</span>
              <div>
                <strong>Frankenstein Build</strong>
                <span>Generate 2 different programs. Then create a third that combines the best features of both</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== PART 2 DIVIDER ===== -->
      <div class="part-divider">
        <h2>&#x1F3AE; Part 2: AI Game Designer</h2>
        <p>Design, build, and play your own web game &mdash; powered by AI!</p>
      </div>

      <!-- Game Type Selector -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F579;&#xFE0F; Choose Your Game</h2>
        <p style="margin-bottom: var(--space-lg); color: var(--color-text-muted);">
          Pick a game type to get started. Clicking a card will load a starter prompt into the game builder below.
        </p>
        <div class="game-grid" id="game-grid">
          <!-- Game cards rendered by JS -->
        </div>
      </div>

      <!-- Code Playground Part 2 (Game) -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F6E0;&#xFE0F; Build Your Game</h2>
        <p style="margin-bottom: var(--space-lg); color: var(--color-text-muted);">
          Describe your game in plain English. AI will generate the code. Play-test it in the preview, then tell AI what to change!
        </p>
        <div class="playground-wrapper" id="playground-part2"></div>
      </div>

      <!-- Level Up Tips -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F4A1; Level Up Your Game</h2>
        <p style="margin-bottom: var(--space-lg); color: var(--color-text-muted);">
          Already have a working game? Click a tip below to copy an improvement idea into the "What to change?" box.
        </p>
        <div class="tips-grid" id="tips-grid">
          <!-- Tip cards rendered by JS -->
        </div>
      </div>

      <!-- Export -->
      <div class="lesson-section">
        <h2 class="section-heading">&#x1F4E6; Save Your Game</h2>
        <div class="export-section">
          <div class="export-info">
            <h3>Download your game as an HTML file</h3>
            <p>You can open it in any browser and share it with friends and family!</p>
          </div>
          <div id="export-btn"></div>
        </div>
      </div>

    </main>

    <!-- Task Sidebar -->
    <aside class="lesson-sidebar">
      <div class="task-sidebar" id="task-sidebar"></div>
    </aside>

  </div>

  <script src="/shared/components.js"></script>
  <script>
    // =============================================
    // Challenge Data (Part 1)
    // =============================================
    var challenges = [
      {
        emoji: '\uD83C\uDFA8',
        name: 'Color Clicker',
        desc: 'A button that changes to a random color when clicked',
        difficulty: 'easy',
        prompt: 'Make a page with a big button in the center. When I click the button, it should change to a random background color. The button should say "Click me!" and be large and rounded.'
      },
      {
        emoji: '\uD83D\uDD22',
        name: 'Click Counter',
        desc: 'A page that counts how many times you click a button',
        difficulty: 'easy',
        prompt: 'Make a page that counts how many times I click a button. Show the count in a big number in the center. The button should say "Click!" below the number. Make it look clean and colorful.'
      },
      {
        emoji: '\u26BD',
        name: 'Bouncing Ball',
        desc: 'A ball that bounces around the screen',
        difficulty: 'medium',
        prompt: 'Create an animation of a colorful ball that bounces around the screen. The ball should bounce off all four walls. Make the ball a bright color and give it a smooth animation. The ball should move on its own as soon as the page loads.'
      },
      {
        emoji: '\u270F\uFE0F',
        name: 'Drawing Canvas',
        desc: 'A canvas where you can draw with the mouse',
        difficulty: 'medium',
        prompt: 'Make a drawing canvas that fills most of the page. When I hold down the mouse button and move, it should draw a colorful line. Add a few color buttons at the top to pick different drawing colors (red, blue, green, black), and a "Clear" button to erase everything.'
      },
      {
        emoji: '\uD83C\uDFAE',
        name: 'Mini Game',
        desc: 'A simple clicking game with a score',
        difficulty: 'hard',
        prompt: 'Create a simple clicking game. A circle should appear at a random position on the screen. When I click on it, my score goes up by 1 and the circle moves to a new random position. Show the score at the top. Add a 30-second timer that counts down, and when time runs out show "Game Over!" with the final score and a "Play Again" button.'
      }
    ];

    // =============================================
    // Game Type Data (Part 2)
    // =============================================
    var gameTypes = [
      {
        emoji: '\u2753',
        name: 'Quiz Game',
        desc: 'Create a trivia quiz with score tracking',
        tag: 'Beginner-friendly',
        quickStart: true,
        prompt: 'Create a fun trivia quiz game with HTML, CSS, and JavaScript. The quiz should have 5 multiple-choice questions about random fun facts (animals, space, food, etc.). Show one question at a time with 4 answer buttons. When the player clicks an answer, highlight it green if correct or red if wrong, then automatically move to the next question after 1 second. Keep track of the score and show a final results screen with a fun message based on how many they got right. Use bright, colorful styling with rounded buttons and a clean layout. Make it look exciting and fun for a 12-year-old!'
      },
      {
        emoji: '\u2B50',
        name: 'Catch Game',
        desc: 'Make a game where you catch falling objects',
        tag: 'Uses mouse/touch',
        quickStart: false,
        prompt: 'Create a catching game with HTML, CSS, and JavaScript using a canvas element. Objects (use emoji like stars, fruits, or coins) fall from the top of the screen at random horizontal positions. The player moves a basket or character at the bottom using the mouse (track mouse X position). When a falling object reaches the basket, the score goes up. If an object hits the ground, the player loses a life (start with 3 lives). Objects should fall faster as the score increases. Show the score and lives at the top. When all lives are lost, show a "Game Over" screen with the final score and a "Play Again" button. Use colorful, fun styling!'
      },
      {
        emoji: '\uD83E\uDDE9',
        name: 'Maze Runner',
        desc: 'Build a maze game with keyboard controls',
        tag: 'Arrow keys',
        quickStart: false,
        prompt: 'Create a maze game with HTML, CSS, and JavaScript. Draw a simple maze on screen using a grid of cells (around 10x10). The player is a colored circle or emoji character that starts in the top-left corner. The goal (shown as a star or flag) is in the bottom-right corner. The player moves with arrow keys. Walls should block movement. Include a move counter and a simple timer that counts seconds. When the player reaches the goal, show a congratulations message with their time and number of moves, and a "Play Again" button that generates the same maze. Use bright colors: walls are dark, the path is light, and the player stands out.'
      },
      {
        emoji: '\uD83D\uDC39',
        name: 'Whack-a-Mole',
        desc: 'Create a clicking speed game',
        tag: 'Fast clicks',
        quickStart: false,
        prompt: 'Create a whack-a-mole style game with HTML, CSS, and JavaScript. Show a 3x3 grid of holes (styled as circles or squares). A mole (use a fun emoji like a hamster or gopher) randomly pops up in one hole at a time and stays for a short duration before hiding. The player clicks/taps the mole to score a point. The game lasts 30 seconds with a visible countdown timer. Moles should appear faster as time goes on. Show the current score prominently. When time runs out, show the final score with a rating (e.g., "Nice!" for 10+, "Amazing!" for 20+, "LEGENDARY!" for 30+) and a "Play Again" button. Make it colorful and bouncy with fun animations!'
      }
    ];

    // =============================================
    // Iteration Tips Data (Part 2)
    // =============================================
    var iterationTips = [
      {
        emoji: '\uD83C\uDFA8',
        title: 'Change the theme',
        desc: 'Switch colors, change emojis, or pick a new visual style (space, ocean, jungle...)',
        mod: 'Change the visual theme: use a space theme with dark background, stars, and space-related emojis. Update all colors to match.'
      },
      {
        emoji: '\uD83D\uDD14',
        title: 'Add sound effects',
        desc: 'Make your game beep, ding, or buzz when things happen!',
        mod: 'Add simple sound effects using the Web Audio API (oscillator beeps, no external files). Add a short high-pitched beep when scoring a point, a low buzz when losing, and a victory jingle when winning.'
      },
      {
        emoji: '\uD83D\uDCCA',
        title: 'Add difficulty levels',
        desc: 'Let players choose Easy, Medium, or Hard before starting',
        mod: 'Add a difficulty selector at the start of the game with three buttons: Easy, Medium, and Hard. Easy should be slower and more forgiving. Hard should be faster and more challenging. Show which difficulty is selected.'
      },
      {
        emoji: '\u23F1\uFE0F',
        title: 'Add a timer',
        desc: 'Challenge players to finish before time runs out!',
        mod: 'Add a countdown timer to the game. Give the player 60 seconds to get the highest score possible. Show the timer prominently at the top. When time runs out, show the final score and a "Try Again" button.'
      },
      {
        emoji: '\uD83C\uDFC6',
        title: 'High score board',
        desc: 'Save top scores so players can try to beat their best',
        mod: 'Add a high score feature using localStorage. After each game, check if the score is a new personal best. Show the top 5 scores on the game-over screen. Highlight the current score if it made the list.'
      },
      {
        emoji: '\u2728',
        title: 'Add animations',
        desc: 'Make things bounce, spin, fade, or explode!',
        mod: 'Add fun CSS animations: make items bounce when they appear, add a pulsing glow effect on the score, show a confetti-like particle burst when the player scores, and add a smooth fade transition between screens.'
      },
      {
        emoji: '\uD83D\uDC64',
        title: 'Player name',
        desc: 'Let the player type their name and show it in the game',
        mod: 'Add a start screen where the player can type their name. Show "Welcome, [name]!" during the game and include their name on the game-over screen with their score.'
      },
      {
        emoji: '\uD83C\uDF1F',
        title: 'Power-ups',
        desc: 'Add special items that give bonus points or extra lives',
        mod: 'Add power-up items that occasionally appear in the game. Include a golden star worth bonus points and a heart that gives an extra life. Power-ups should look different from regular items and have a special animation when collected.'
      }
    ];

    // =============================================
    // Part 1: Challenge Cards
    // =============================================
    var challengeGrid = document.getElementById('challenge-grid');

    challenges.forEach(function (challenge) {
      var card = document.createElement('div');
      card.className = 'challenge-card';

      var emojiEl = document.createElement('div');
      emojiEl.className = 'challenge-emoji';
      emojiEl.textContent = challenge.emoji;

      var nameEl = document.createElement('div');
      nameEl.className = 'challenge-name';
      nameEl.textContent = challenge.name;

      var descEl = document.createElement('div');
      descEl.className = 'challenge-desc';
      descEl.textContent = challenge.desc;

      var diffLabel = document.createElement('span');
      diffLabel.className = 'difficulty';
      if (challenge.difficulty === 'easy') {
        diffLabel.classList.add('difficulty-easy');
        diffLabel.textContent = 'Easy';
      } else if (challenge.difficulty === 'medium') {
        diffLabel.classList.add('difficulty-medium');
        diffLabel.textContent = 'Medium';
      } else {
        diffLabel.classList.add('difficulty-hard');
        diffLabel.textContent = 'Hard';
      }

      card.appendChild(emojiEl);
      card.appendChild(nameEl);
      card.appendChild(descEl);
      card.appendChild(diffLabel);

      card.addEventListener('click', function () {
        // Deselect all challenge cards
        var allCards = challengeGrid.querySelectorAll('.challenge-card');
        allCards.forEach(function (c) { c.classList.remove('card-selected'); });
        // Select this one
        card.classList.add('card-selected');

        // Load prompt into Part 1 playground's generate textarea
        var genTextarea = document.querySelector('#playground-part1 textarea');
        if (genTextarea) {
          genTextarea.value = challenge.prompt;
          genTextarea.focus();
        }

        // Scroll to playground
        document.getElementById('playground-part1').scrollIntoView({ behavior: 'smooth', block: 'start' });
      });

      challengeGrid.appendChild(card);
    });

    // =============================================
    // Part 1: Code Playground
    // =============================================
    var playgroundPart1Container = document.getElementById('playground-part1');
    var part1GenCount = 0;

    var playgroundPart1 = window.CodePlayground(playgroundPart1Container, {
      onRun: function (code) {
        if (code && code.length > 50) {
          taskCards.setComplete('build-first', true);
          part1GenCount++;
          if (part1GenCount >= 3) {
            taskCards.setComplete('complete-three', true);
          }
        }
      },
      guidedTasks: challenges.map(function (c) {
        return {
          title: c.emoji + ' ' + c.name,
          description: c.desc,
          prompt: c.prompt
        };
      })
    });

    // =============================================
    // Part 2: Game Type Selector
    // =============================================
    var gameGrid = document.getElementById('game-grid');

    gameTypes.forEach(function (game) {
      var card = document.createElement('div');
      card.className = 'game-card';

      if (game.quickStart) {
        var badge = document.createElement('span');
        badge.className = 'quick-start';
        badge.textContent = 'Easy Start';
        card.appendChild(badge);
      }

      var emojiEl = document.createElement('span');
      emojiEl.className = 'game-emoji';
      emojiEl.textContent = game.emoji;

      var nameEl = document.createElement('div');
      nameEl.className = 'game-name';
      nameEl.textContent = game.name;

      var descEl = document.createElement('div');
      descEl.className = 'game-desc';
      descEl.textContent = game.desc;

      var tagEl = document.createElement('span');
      tagEl.className = 'game-tag';
      tagEl.textContent = game.tag;

      card.appendChild(emojiEl);
      card.appendChild(nameEl);
      card.appendChild(descEl);
      card.appendChild(tagEl);

      card.addEventListener('click', function () {
        // Deselect all game cards
        var allCards = gameGrid.querySelectorAll('.game-card');
        allCards.forEach(function (c) { c.classList.remove('card-selected'); });

        // Select this one
        card.classList.add('card-selected');

        // Pre-fill the Part 2 playground prompt
        var promptArea = document.querySelector('#playground-part2 textarea');
        if (promptArea) {
          promptArea.value = game.prompt;
          promptArea.focus();
          document.getElementById('playground-part2').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        taskCards.setComplete('choose-game', true);
      });

      gameGrid.appendChild(card);
    });

    // =============================================
    // Part 2: Code Playground (Game)
    // =============================================
    var playgroundPart2Container = document.getElementById('playground-part2');
    var gameGenCount = 0;

    var playgroundPart2 = window.CodePlayground(playgroundPart2Container, {
      onRun: function (code) {
        gameGenCount++;
        if (gameGenCount >= 1) {
          taskCards.setComplete('choose-game', true);
        }
        if (gameGenCount >= 2) {
          taskCards.setComplete('playtest', true);
        }
      }
    });

    // =============================================
    // Part 2: Iteration Tips
    // =============================================
    var tipsGrid = document.getElementById('tips-grid');
    var tipClickCount = 0;

    iterationTips.forEach(function (tip) {
      var card = document.createElement('div');
      card.className = 'tip-card';

      var emojiEl = document.createElement('div');
      emojiEl.className = 'tip-emoji';
      emojiEl.textContent = tip.emoji;

      var titleEl = document.createElement('div');
      titleEl.className = 'tip-title';
      titleEl.textContent = tip.title;

      var descEl = document.createElement('div');
      descEl.className = 'tip-desc';
      descEl.textContent = tip.desc;

      card.appendChild(emojiEl);
      card.appendChild(titleEl);
      card.appendChild(descEl);

      card.addEventListener('click', function () {
        // Find the modification textarea in Part 2 playground (second textarea)
        var textareas = document.querySelectorAll('#playground-part2 textarea');
        if (textareas.length >= 2) {
          textareas[1].value = tip.mod;
          textareas[1].focus();
          document.getElementById('playground-part2').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        tipClickCount++;
        if (tipClickCount >= 2) {
          taskCards.setComplete('playtest', true);
        }
      });

      tipsGrid.appendChild(card);
    });

    // =============================================
    // Part 2: Export Button
    // =============================================
    var exportContainer = document.getElementById('export-btn');

    window.ExportButton(exportContainer, {
      label: 'Download My Game',
      getData: function () {
        var code = playgroundPart2.getCode();
        if (!code) {
          // Fall back to Part 1 code if no game was built
          code = playgroundPart1.getCode();
        }
        if (!code) {
          return '<!-- No code generated yet! Go back and build something first. -->';
        }
        taskCards.setComplete('export-game', true);
        return code;
      },
      filename: 'my-ai-game.html',
      format: 'html'
    });

    // =============================================
    // Task Sidebar
    // =============================================
    var taskSidebar = document.getElementById('task-sidebar');

    var taskCards = window.TaskCards(taskSidebar, [
      { id: 'build-first', title: 'Build your first program', description: 'Generate any program using the Part 1 playground' },
      { id: 'complete-three', title: 'Complete 3 coding challenges', description: 'Try at least 3 different challenges in Part 1' },
      { id: 'vibe-challenge', title: 'Try a Vibe Coding challenge', description: 'Complete one of the 3 vibe coding challenges' },
      { id: 'choose-game', title: 'Choose and generate a game', description: 'Pick a game type and generate it in Part 2' },
      { id: 'playtest', title: 'Play-test and improve 2 times', description: 'Use tips or your own ideas to iterate' },
      { id: 'export-game', title: 'Export your game', description: 'Download your game as an HTML file' }
    ]);

    // =============================================
    // Vibe Challenge click handlers
    // =============================================
    var vibeChallengeItems = document.querySelectorAll('.vibe-challenge-item');
    vibeChallengeItems.forEach(function (item) {
      item.addEventListener('click', function () {
        taskCards.setComplete('vibe-challenge', true);
        document.getElementById('playground-part1').scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    });
  </script>

</body>
</html>
